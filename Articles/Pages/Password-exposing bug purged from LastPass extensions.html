<figure class="intro-image intro-left">
  <img src="https://cdn.arstechnica.net/wp-content/uploads/2016/05/Screen-Shot-2016-05-31-at-2.56.38-PM-640x426.png" alt="Screenshot from gameshow Password."/>
      <p class="caption" style="font-size:0.8em">Still image from the long-running but currently defunct gameshow <em>Password</em>. (credit: <a rel="nofollow" class="caption-link" href="https://www.gettyimages.com/editorial-images/abc">ABC Photo Archives / Getty Images</a>)</p>  </figure>






<div><a name='page-1'></a></div>
<p>Developers of the LastPass password manager have patched a vulnerability that made it possible for websites to steal credentials for the last account the user logged into using the Chrome or Opera extension.</p>
<p>The vulnerability was discovered late last month by Google Project Zero researcher Tavis Ormandy, who privately reported it to LastPass. In a <a href="https://bugs.chromium.org/p/project-zero/issues/detail?id=1930">write-up that became public on Sunday</a>, Ormandy said the flaw stemmed from the way the extension generated popup windows. In certain situations, websites could produce a popup by creating an HTML <a href="https://www.w3schools.com/tags/tag_iframe.asp">iframe</a> that linked to the Lastpass popupfilltab.html window rather than through the expected procedure of calling a function called do_popupregister(). In some cases, this unexpected method caused the popups to open with a password of the most recently visited site.</p>
<p>"Because do_popupregister() is never called, ftd_get_frameparenturl() just uses the last cached value in g_popup_url_by_tabid for the current tab," Ormandy wrote. "That means via some clickjacking, you can leak the credentials for the previous site logged in for the current tab."</p>
<p>Clickjacking is a class of attack that conceals the true destination of the site or resource displayed in a Web link. In its most common form, clickjacking attacks place a malicious link in a transparent layer on top of a visible link that looks innocuous. Users who click on the link open the malicious page or resource rather than the one that appears to be safe.</p>
<p>"This will prompt if you try to clickjack filling in or copying credentials though, because frame_and_topdoc_has_same_domain() returns false," Ormandy continued. "This is possible to bypass, because you can make them match by finding a site that will iframe an untrusted page."</p>
<p>The researcher then showed how a bypass might work by combining two domains into a single URLs such as:</p>
<p><a href="https://translate.google.com/translate?sl=auto&amp;tl=en&amp;u=https://www.example.com/">https://translate.google.com/translate?sl=auto&amp;tl=en&amp;u=https://www.example.com/</a></p>
<p>In a series of updates, Ormandy described easier ways to carry out the attack. He also described three other weaknesses he found in the extensions, including:</p>
<ul>
<li>the handle_hotkey() didn't check for trusted events, allowing sites to generate arbitrary hotkey events</li>
<li>a bug that allowed attackers to disable several security checks by putting the string "https://login.streetscape.com" in code</li>
<li>a routine called LP_iscrossdomainok() that could bypass other security checks</li>
</ul>
<p>On Friday, LastPass published a <a href="https://blog.lastpass.com/2019/09/lastpass-bug-reported-resolved.html/">post</a> that said the bugs had been fixed and described the "limited set of circumstances" required for the flaws to be exploited.</p>
<p>"To exploit this bug, a series of actions would need to be taken by a LastPass user including filling a password with the LastPass icon, then visiting a compromised or malicious site and finally being tricked into clicking on the page several times," LastPass representative Ferenc Kun wrote. "This exploit may result in the last site credentials filled by LastPass to be exposed. We quickly worked to develop a fix and verified the solution was comprehensive with Tavis."</p>
<h2>Don’t ditch your password manager just yet</h2>
<p>The vulnerability underscores the drawback of password managers, a tool that many security practitioners say is essential for good security hygiene. By making it easy to generate and store a strong password that's unique for every account, password managers offer a crucial alternative to password reuse. Password managers also make it much easier to use passwords that are truly strong, since users need not memorize them. In the event that a website breach exposes user passwords in cryptographically protected form, the chances of someone being able to crack the hash are slim, since the plaintext password is strong. Even in the event that the website breach leaks passwords in plaintext, the password manager ensures that only a single account is compromised.</p>
<p>The downside to password managers is that if or when they fail, the results can be severe. It's not unusual for some people to use password managers to store hundreds of passwords, some for banking, 401k, and email accounts. In the event of a password-manager hack, there's the risk that the credentials for multiple accounts can be exposed. On the whole, I still recommend most people use password managers unless they devise another technique to generate and store strong passwords that are unique to every account.</p>
<p>One way to reduce the damage that can occur in the event of a password manager hack is to use multi-factor authentication whenever possible. By far, the cross-industry <a href="https://en.wikipedia.org/wiki/WebAuthn">WebAuthn</a> is the most secure and user-friendly form of MFA, but <a href="https://en.wikipedia.org/wiki/Time-based_One-time_Password_algorithm">time-based one-time-password</a> generated by authenticator apps are also relatively secure. And despite the criticism SMS-based MFA gets—for <a href="https://arstechnica.com/information-technology/2017/05/thieves-drain-2fa-protected-bank-accounts-by-abusing-ss7-routing-protocol/">good reason</a>, by the way—even meager protection would likely be enough to protect most people against account takeovers.</p>
<p>The LastPass bug was fixed in <a href="https://lastpass.com/upgrade.php?fromwebsite=1&amp;releasenotes=1">version 4.33.0</a>. The extension update should automatically install on users' computers, but it's not a bad idea to check. While LastPass said the bug was limited to the Chrome and Opera browsers, the company has deployed the update to all browsers as a precaution.</p>

<p><a href="https://arstechnica.com/?p=1569151&comments=1">Read Comments</a></p>